<html>
<head>
	<title>ow.persistState Demo</title>
	<link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css" rel="stylesheet">
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.10.3/css/base/jquery.ui.all.min.css">
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/7.3/styles/dark.min.css">
	<style type="text/css">
		.examples>li {
			margin: 1em;
		}
		.resizable {
			background-color: lime;
			overflow: hidden;
		}
		body { background-color: #FAFAFC;}
		.separate {
			padding-bottom: 1em;
			margin-bottom: 1.5em;
			border-bottom: 1px solid #CCC;
		}
	</style>
</head>
<body>

<div class="container">
<h1 class="page-header">The persistState Widget <small>A Demo</small></h1>
<div class="row-fluid separate">
	<p class="span8">
	Try playing around with the controls below and refreshing the page. Note that the state of these controls persists. This page loads jQuery, jQuery Ui, and the persistState widget. It then initializes everything like so:	
	</p>
	<div class="span4">
<pre><code class="javascript">$(function(){
	$('.persist-state').persistState();
})</code></pre>		
	</div>
</div>

<ul class="examples unstyled">
	<li class="row-fluid">	
		<section id="checkbox-example" class="span4">
			<label>
				<span class="label">This is a checkbox</span>
				<input type="checkbox" class="persist-state">
			</label>
		</section>
		<div class="span8">
			<p>This is what the html looks like:</p>
			<code class="example-html"></code>			
		</div>
	</li>

	<li class="row-fluid">
		<section id="input-text-example" class="span4">
			<label>
				<span class="label">This is text input</span>
				<input class="persist-state" placeholder="Type some text in here">
			</label>
		</section>
		<div class="span8">
			<p>This is what the html looks like:</p>
			<code class="example-html"></code>
		</div>
	</li>

	<li class="row-fluid">
		<section id="select-example" class="span4">
			<label>
				<span class="label">This is a selector</span>
				<select class="persist-state">
					<option value="1">Option 1</option>
					<option value="2">Option 2</option>
					<option value="3">Option 3</option>
				</select>
			</label>
		</section>
		<div class="span8">
			<p>This is what the html looks like:</p>
			<code class="example-html"></code>
		</div>
	</li>

	<li class="row-fluid">
		<section id="resizable-example" class="span4">
			<label>
				<div class="resizable persist-state">
					<p>This block is resizable with jQuery Ui resizable</p>
					<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
					tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
					quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
					consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
					cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
					proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
				</div>
			</label>
		</section>
		<div class="span8">
			<p>This is what the html looks like:</p>
			<code class="example-html"></code>
		</div>
	</li>
</ul>

<section id="localStorage-contents" class="row-fluid hero-unit">
	<p>The following are the contents of persistState in your localStorage:</p>
	<pre><code class="javascript"></code></pre>
	<button class="clear-localStorage">Clear It Out</button>
	<aside>This will remove any unload events so your next refresh will not persist but following ones will.</aside>
</section>
</div>

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/7.3/highlight.min.js"></script>
<script src="../src/ow.widgets.persistState.js"></script>

<script type="text/javascript">
//Get all the code inserted
$(function(){
	$('.examples>li').each(function(i, el){
        var  code = $('section', el).html()
            ,allLines = code.split('\n')
            ,lines = allLines.filter(function(l){return !/\!function()/.test(l) && !/}\(\)/.test(l) }) //remove iife

            //shift over code to get rid of highest indentation level so that we can still use white-space: pre
            ,firstLineOfText = lines.filter(function(l){return l.trim()})[0]
            ,indentationLevel = firstLineOfText.match(/^\s+/)[0].length

            ,codeMinusIndentationLevel = lines.map(function(l){ return l.substr(indentationLevel)}).join('\n').trim()
            ;
		var $code = $('code', el).text( codeMinusIndentationLevel );
		$code.addClass('html').wrap('<pre>'); //for highlight.js
		hljs.highlightBlock($code[0]);
	})
})	
</script>

<script type="text/javascript">
//The localStorage view panel
$(function(){
	function showLocalStorage() {
		var code = JSON.stringify( JSON.parse(localStorage['//persistenceState']||'null'), null, 2);
		$('#localStorage-contents code').text(code);
	}
	$('.clear-localStorage').click(function(){ $(':ow-persistState').persistState('clear'); showLocalStorage(); });
	showLocalStorage();
})
</script>

<script type="text/javascript">
$(function(){

})
</script>

<script type="text/javascript">
$(function(){
	//initialize jquery ui widgets for the example
	$('.resizable').resizable();
	//initialize the persist state widget itself. The widget will attempt
	//to restore state upon initialization
	$('.persist-state').persistState();
})
</script>
</body>
</html>	